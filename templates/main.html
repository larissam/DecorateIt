{% extends "layout.html" %}

{% block header %}
<link rel="stylesheet" type="text/css" href="{{ url_for('static', filename='bootstrap/css/bootstrap.css') }}">
<link rel="stylesheet" type="text/css" href="{{ url_for('static', filename='bootstrap/css/bootstrap-theme.css') }}">
<script type="text/javascript" src="{{ url_for('static', filename='bootstrap/js/bootstrap.min.js') }}"></script>
<script language="javascript" type="text/javascript" src="{{ url_for('static', filename='js/jquery-1.11.0.min.js')}}"></script>
<script language="javascript" type="text/javascript" src="{{ url_for('static', filename='js/freewall.js')}}"></script>

<style>
	/* for gallery */
		.gallery {
			display: block;
			text-align: center;
			position: relative;
			padding: .7em .7em .7em .7em;
			min-height: 0;
			font-size: 100%;
			background: #470024;
			border-top: 10px solid black;
		}
		.gallery > img {
			-webkit-filter: opacity(0.4);
		}

		.gallery >img:hover {
			-webkit-filter: opacity(1);
		}
		.gallery-img-active {
			-webkit-filter: opacity(1);
		}

	/* for accordion */
		h3 > img {
			-webkit-filter: invert(1);
		}
		.h3-faux-accordion {
			display: block;
			text-align: center;
			position: relative;
			margin: 2px 0 0 0;
			padding: .5em .5em .5em .7em;
			min-height: 0;
			font-size: 100%;
			height: 42px; /* JS changes this. used to be 48 */
		}

	/* for accordion icons and tool selection */
		button {
			border: none;
			background: none;
			/*-webkit-filter: opacity(0.4);*/
			-webkit-filter: opacity(1);
		}

		button:hover {
			-webkit-filter: brightness(50%);
		}

		button:focus {
			outline: 0 !important;
		}
		.accordion-button-adjustment {
			-webkit-filter: opacity(0.4) !important;
		}

		.icon-inactive {
			display:inline-block; 
			-webkit-filter: invert(1);
		}

		.button-active {
			border: none;
			background: none;
			-webkit-filter: none;
		}

	

	/* for radio buttons */

	/* for thumbnails */
	.thumbnail-size {
		width: 300px;
	}

	.add-button-size {
		margin-top: 51px;
		margin-bottom: 51px;
		margin-left: 86px;
		margin-right: 86px;
	}

	/* for hover overlays */
		.hidden {
			visibility: hidden;
		}

	div.purikura {
		-webkit-filter: opacity(1);
	}

	div.purikura:hover {
		-webkit-filter: opacity(0.5);
	}

	div.purikuraOptions {
		position: relative;
		top: 30px;
		left: 230px;
	}

	.purikura, .purikura img {
	  position:relative;
	  width:250px;
	}
	.purikuraOptions {
	  display:none;
	  position:absolute;
	  top:15px;
	  right:15px;
	  width:25px;
	  height:25px;
	  background-image:url( "{{ url_for('static', filename='images/gallerydelete.png') }}" );
	}
	.purikura:hover .purikuraOptions {
	  display:block;
	}
	.purikuraOptions:hover {
	  background-image:url( "{{ url_for('static', filename='images/gallerydelete.png') }}" );
	}

	.brick img {
		margin: 0;
		display: block;
	}

</style>

{% endblock %}
{% block content %}

{% if session.logged_in %}

<h2>My Gallery</h2>

<div id="purikuraList">


    
</div>

<div id="container">


<div class="col-md-3 brick">
    	<!-- the link goes to a "details" page -->

    	<!-- width styling is so it scales smaller -->
    	<button><a href="{{ url_for('choose') }}"><img src="{{ url_for('static', filename='images/navigatorplus.png') }}" class="img-thumbnail add-button-size" /></a></button>
    	<!-- <div class="hidden">
    		<a href=""><img src="{{ url_for('static', filename='images/socialmediaiconfacebook.png') }}" /></a>
    	</div> -->
</div>

    {% for purikura in purikura_list %}
    <div class="col-md-3 brick">
    	<!-- <a href="/purikura/{{ purikura.id }}"><img src="{{ purikura.combined_src }}" /></a> -->
        <!-- <a class="btn btn-primary" href="/purikura/{{ purikura.id }}">Details</a> -->

        <!-- <div class="purikura">
        	<div class="purikuraOptions hidden">
    			<button><img src="{{ url_for('static', filename='images/gallerydelete.png') }}" /></button>
    		</div>	
        	<a href="/purikura/{{ purikura.id }}"><img src="{{ purikura.combined_src }}" class="img-thumbnail thumbnail-size" /></a>
        	
        </div> -->

        <div class="purikura">
		  <img src="{{ purikura.combined_src }}" class="img-thumbnail thumbnail-size"/>
		  
		  <form action="{{ url_for('delete_purikura') }}" method=POST>
		  	<input type="hidden" name="filename" value="{{ purikura.combined_src }}">
		  	<button class="purikuraOptions"></button>
		  </form>
		</div>
        
        
    </div>
    {% endfor %}

</div>

<script>

//reload the page once, just in case you made some database changes when you were using the editor
window.onload = function() {
    if(!window.location.hash) {
        window.location = window.location + '#loaded';
        window.location.reload();
    }
}

// $(function() {
//       var wall = new freewall("#purikuraList");
//       wall.fitWidth();
//     });

// $(function() {
//       var wall = new freewall("#container");


//       wall.fitWidth();
//     });

// var temp = "<div class='brick' style='width:{width}px;'><img src='{path}' width='100%'></div>";
// 			var w = 1, h = 1, html = '', limitItem = {{ purikura_list.length }};
// 			for (var i = 0; i < limitItem; ++i) {
// 				w = 1 + 3 * Math.random() << 0;
// 				html += temp.replace(/\{width\}/g, w*150).replace("{path}", purikura_list[i].combined_src);
// 			}
// 			$("#freewall").html(html);
			
			var wall = new freewall("#container");
			wall.reset({
				selector: '.brick',
				animate: true,
				cellW: 250, //250 makes it line up better - why?
				cellH: 'auto',
				onResize: function() {
					wall.fitWidth();
				}
			});

			var images = wall.container.find('.brick');
			images.find('img').load(function() {
				wall.fitWidth();
			});
		
</script>

{% endif %}


{% endblock %}
